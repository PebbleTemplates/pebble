<!DOCTYPE HTML>
<!--
    Editorial by HTML5 UP
    html5up.net | @ajlkn
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<head>




<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
<meta name="generator" content="Orchid 0.17.4"/>
<link rel="icon" href="https://pebbletemplates.io/favicon.ico">


<meta name="robots" content="index, follow">



<title>Escaping</title>


<meta name="description" content="">



<link rel="prev" href="https://pebbletemplates.io/wiki/guide/customize-defaults">


<link rel="next" href="https://pebbletemplates.io/wiki/guide/extending-pebble">


<script>
    window.site = {"orchidVersion":"0.17.4","baseUrl":"https://pebbletemplates.io","environment":"prod","version":"4.1.1"};
</script>




<link rel="icon" type="image/png" href="favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16" />
<!-- start:inject styles -->
<link rel="stylesheet" type="text/css" href="https://pebbletemplates.io/Editorial/614fa662/assets/css/editorial_main.css"/>
<link rel="stylesheet" type="text/css" href="https://pebbletemplates.io/Editorial/614fa662/assets/css/editorial_orchidCustomizations.css"/>
<link rel="stylesheet" type="text/css" href="https://pebbletemplates.io/Editorial/614fa662/assets/css/orchidSearch.css"/>
<link rel="stylesheet" type="text/css" href="https://pebbletemplates.io/assets/css/pygments.css"/>
<link rel="stylesheet" type="text/css" href="https://pebbletemplates.io/assets/css/github-fork-ribbon.css"/>
<link rel="stylesheet" type="text/css" href="https://pebbletemplates.io/ajax/libs/prism/1.8.4/themes/prism.min.css"/>
<!-- end:inject styles -->

</head>
<body class="is-loading">


<!-- Wrapper -->
<div id="wrapper">

    <!-- Main -->
    <div id="main">
        <a class="github-fork-ribbon" href="https://github.com/PebbleTemplates" data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a>
        <div class="inner">

            <!-- Header -->
            
                <header id="header">
    <a href="https://pebbletemplates.io" class="logo">Pebble Templates</a>
    <ul class="icons">
    
    
    
    </ul>
</header>
            
            
            
            
                <section id="pageContent">
                    <header class="major"><h2>Escaping</h2></header>
                    <article>
                        
    <!-- start:inject components -->
    
        
            
                
                    
                        <h1 id="escaping">Escaping</h1>
<h2 id="overview">Overview</h2>
<p><a href="https://en.wikipedia.org/wiki/Cross-site_scripting">XSS vulnerabilites</a> are the most common types of security
vulnerabilities in web applications and in order to avoid them you must escape potentially unsafe data before
presenting it to the end user. Pebble provides autoescaping of all such data which is enabled by default.
Autoescaping can be turned off, in which case Pebble provides an <a href="https://pebbletemplates.io/wiki/filter/escape">escape</a> filter for more
fine-grained manual escaping.</p>
<h2 id="autoescaping">Autoescaping</h2>
<p>Autoescaping, which is enabled by default, will automatically escape the outcome of expressions
contained within print delimiters, i.e. <code>{{</code> and <code>}}</code>:</p>
<pre><code class="language-twig">{% set danger = &quot;&lt;br&gt;&quot; %}
{{ danger }}

{# will output: &amp;lt;br&amp;gt; #}
</code></pre>
<p>The <a href="https://pebbletemplates.io/wiki/filter/raw">raw</a> filter can be used to prevent the autoescaper from escaping a particular expression. It is
important that the raw filter is the last operation performed in the expression.</p>
<pre><code class="language-twig">{% set danger = &quot;&lt;br&gt;&quot; %}
{{ danger | raw }}

{# will output: &lt;br&gt; #}
</code></pre>
<p>If the raw filter is not the last operation performed within the expression, the expression will be deemed
as possibly unsafe by the autoescaper and will be escaped. For example:</p>
<pre><code class="language-twig">{% set danger = &quot;&lt;br&gt;&quot; %}
{{ danger | raw | uppercase }}

{# will output: &amp;lt;BR&amp;gt; #}
</code></pre>
<h3 id="exceptions">Exceptions</h3>
<p>There are a few exceptions where expressions are <strong>not</strong> automatically escaped:</p>
<ul>
<li>If the expression only contains a string literal, it is assumed to be safe. For example:</li>
</ul>
<pre><code class="language-twig">{{ '&lt;br&gt;' }}

{# will output: &lt;br&gt; #}
</code></pre>
<ul>
<li>The last operation contained within that expression is a filter or function that explicitly returns safe output. Such a filter or function would return an instance of <code>SafeString</code> instead of a regular String. The built-in filters that return safe markup include: <code>date</code>, <code>escape</code>, and <code>raw</code>. These filters must be the last operation performed within the expression in order for their output to be ignored by the autoescaper. For example:</li>
</ul>
<pre><code class="language-twig">{% set danger = &quot;&lt;br&gt;&quot; %}
{{ danger | uppercase | raw }}

{# will output: &lt;br&gt; #}
</code></pre>
<h3 id="autoescape-tag">Autoescape Tag</h3>
<p>The <a href="https://pebbletemplates.io/wiki/tag/autoescape">autoescape</a> tag can be used to temporarily disable/re-enable the autoescaper as well as
change the escaping strategy for a portion of the template.</p>
<pre><code class="language-twig">{{ danger }} {# will be escaped by default #}
{% autoescape false %}
	{{ danger }} {# will not be escaped #}
{% endautoescape %}
</code></pre>
<pre><code class="language-twig">{{ danger }} {# will use the &quot;html&quot; escaping strategy #}
{% autoescape &quot;js&quot; %}
	{{ danger }} {# will use the &quot;js&quot; escaping strategy #}
{% endautoescape %}
</code></pre>
<h3 id="disabling-autoescaper">Disabling Autoescaper</h3>
<pre><code class="language-java">PebbleEngine engine = new PebbleEngine.Builder().autoEscaping(false).build();
</code></pre>
<h2 id="manual-escaping">Manual Escaping</h2>
<p>If autoescaping is disabled you can still use the <a href="https://pebbletemplates.io/wiki/filter/escape">escape</a> filter to aid with manual escaping:</p>
<pre><code class="language-twig">{% set danger = &quot;&lt;br&gt;&quot; %}
{{ danger | escape }}

{# will output: &amp;lt;br&amp;gt; #}
</code></pre>
<h2 id="strategies">Strategies</h2>
<p>When escaping data it is crucial that you utilize the correct escaping strategy depending on the context of the data.
By default, the autoescaper and the <code>escape</code> filter assume that you are escaping HTML data.
I highly recommend reading the <a href="https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet">OWASP Cheat Sheet</a>
to understand the significance of escaping context.</p>
<p>Pebble provides the following escaping strategies:</p>
<ul>
<li>html</li>
<li>js</li>
<li>css</li>
<li>url_param</li>
</ul>
<p>You can use the <a href="https://pebbletemplates.io/wiki/tag/autoescape">autoescape</a> tag to temporarily change the strategy used by the autoescaper otherwise you can
change the globally used default strategy:</p>
<pre><code class="language-java">PebbleEngine engine = new PebbleEngine.Builder().defaultEscapingStrategy(&quot;js&quot;).build();
</code></pre>
<p>The escape filter will also accept a strategy as an argument:</p>
<pre><code class="language-js">var username =&quot;{{ user.name | escape(strategy=&quot;js&quot;) }}&quot;;
</code></pre>
<h3 id="custom-strategy">Custom Strategy</h3>
<p>You can add a custom escaping strategy by implementing <code>EscapingStrategy</code> and adding it to the <code>EscaperExtension</code>:</p>
<pre><code class="language-java">PebbleEngine engine = new PebbleEngine.Builder().addEscapingStrategy(&quot;custom&quot;, new CustomEscapingStrategy()).build();
</code></pre>

                    
                
            
        
            
        
    
    <!-- end:inject components -->


                    </article>
                </section>
            
        </div>
        <hr>

        <!-- Page Footer -->
        <div class="inner">
    <footer id="footer">
        <div class="clearfix">
            
                <div class="float-left">
                    <a href="https://pebbletemplates.io/wiki/guide/customize-defaults" class="button special small pill">
                        <span>&larr;</span> Customize Defaults
                    </a>
                </div>
            
            
                <div class="float-right">
                    <a href="https://pebbletemplates.io/wiki/guide/extending-pebble" class="button special small pill">
                        Extending Pebble<span>&rarr;</span>
                    </a>
                </div>
            
        </div>
    </footer>
</div>

    </div>

    <!-- Sidebar -->
    <div id="sidebar">
    <div class="inner">

        <!-- Search -->
        <section id="search" class="alt">
            <form data-orchid-search="">
                <input type="text" name="query" id="query" placeholder="Search"/>
            </form>
            <div class="box" id="search-results" data-orchid-search-results style="display: none;">
                <b>Search Results</b>
                <ul></ul>
            </div>
            <div class="box" id="search-progress" data-orchid-search-progress style="display: none;">
                <div class="loader">Loading...</div>
            </div>
        </section>

        <!-- Menu -->
        <nav id="siteNav" class="menu">
            <header class="major">
                <h2>Pebble Templates</h2>
            </header>
            <ul class="top-level">
                
                    
    
    <li>
        <a class="subheader">About</a>
    </li>
    

                
                    
    
    <li>
        <a href="https://pebbletemplates.io">Home</a>
    </li>
    

                
                    
    
    <li>
        <a href="https://pebbletemplates.io/wiki/guide/spring-boot-integration">Spring Boot Integration</a>
    </li>
    

                
                    
    
    <li>
        <a href="https://github.com/PebbleTemplates/spring-petclinic">Spring petclinic example</a>
    </li>
    

                
                    
    
    <li>
        <a href="https://pebbletemplates.io/twig-compatibility">Twig Compatibility</a>
    </li>
    

                
                    
    
    <li>
        <a href="https://pebbletemplates.io/contributing">Contributing</a>
    </li>
    

                
                    
    
    <li>
        <a href="https://pebbletemplates.io/changelog">Changelog</a>
    </li>
    

                
                    
    
    <li>
        <a href="https://pebbletemplates.io/wiki/book.pdf">Offline Documentation (PDF)</a>
    </li>
    

                
                    
    
    <li>
        <a href="https://buymeacoffee.com/erbussierel">Buy me a coffee</a>
    </li>
    

                
                    
    
    <li>
        <a class="subheader">Wiki</a>
    </li>
    

                
                    
    <li>
        <span class="opener">Guide</span>
        <ul>
        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/guide/installation">Installation and Configuration</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/guide/spring-boot-integration">Spring Boot Integration</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/guide/basic-usage">Basic Usage</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/guide/customize-defaults">Customize Defaults</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/guide/escaping">Escaping</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/guide/extending-pebble">Extending Pebble</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/guide/high-performance">High Performance Techniques</a>
    </li>
    

        
        </ul>
    </li>

                
                    
    <li>
        <span class="opener">Tag</span>
        <ul>
        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/autoescape">autoescape</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/block">block</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/cache">cache</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/embed">embed</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/extends">extends</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/filter">filter</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/flush">flush</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/for">for</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/from">from</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/if">if</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/import">import</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/include">include</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/macro">macro</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/parallel">parallel</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/set">set</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/tag/verbatim">verbatim</a>
    </li>
    

        
        </ul>
    </li>

                
                    
    <li>
        <span class="opener">Filter</span>
        <ul>
        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/abbreviate">abbreviate</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/abs">abs</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/base64decode">base64decode</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/base64encode">base64encode</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/capitalize">capitalize</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/date">date</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/default">default</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/escape">escape</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/first">first</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/join">join</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/last">last</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/length">length</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/lower">lower</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/numberformat">numberformat</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/raw">raw</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/replace">replace</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/reverse">reverse</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/rsort">rsort</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/sha256">sha256</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/slice">slice</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/sort">sort</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/split">split</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/title">title</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/trim">trim</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/upper">upper</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/filter/urlencode">urlencode</a>
    </li>
    

        
        </ul>
    </li>

                
                    
    <li>
        <span class="opener">Function</span>
        <ul>
        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/function/blockFunction">block</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/function/i18n">i18n</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/function/max">max</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/function/min">min</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/function/parent">parent</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/function/range">range</a>
    </li>
    

        
        </ul>
    </li>

                
                    
    <li>
        <span class="opener">Test</span>
        <ul>
        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/test/empty">empty</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/test/even">even</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/test/map">map</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/test/null">null</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/test/odd">odd</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/test/iterable">iterable</a>
    </li>
    

        
        </ul>
    </li>

                
                    
    <li>
        <span class="opener">Operator</span>
        <ul>
        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/operator/comparisons">comparisons</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/operator/contains">contains</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/operator/is">is</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/operator/logic">logic</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/operator/math">math</a>
    </li>
    

        
            
    
    <li>
        <a href="https://pebbletemplates.io/wiki/operator/others">others</a>
    </li>
    

        
        </ul>
    </li>

                
                    
    
    <li>
        <a class="subheader">API Docs</a>
    </li>
    

                
            </ul>
        </nav>
        

        <!-- Section -->
        <section>
            <p class="text-center">
                Currently 4.1.1.
            </p>
        </section>

        <!-- Footer -->
        <footer id="footer">
            <p class="copyright text-center">
                &copy; PebbleTemplates. All rights reserved.
                <br>
                Site created with <a href="https://orchid.netlify.com">Orchid </a>,
                design by <a href="https://html5up.net">HTML5 UP</a>.
            </p>
        </footer>

    </div>
</div>
</div>

<!-- start:inject scripts -->
<script src="https://pebbletemplates.io/Editorial/614fa662/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://pebbletemplates.io/Editorial/614fa662/ajax/libs/skel/3.0.1/skel.min.js"></script>
<script src="https://pebbletemplates.io/Editorial/614fa662/assets/js/editorial_util.js"></script>
<script src="https://pebbletemplates.io/Editorial/614fa662/assets/js/editorial_main.js"></script>
<script src="https://pebbletemplates.io/Editorial/614fa662/assets/js/editorial_orchidCustomizations.js"></script>
<script src="https://pebbletemplates.io/Editorial/614fa662/lunr/lunr.js"></script>
<script src="https://pebbletemplates.io/Editorial/614fa662/assets/js/orchidSearch.js"></script>
<script src="https://pebbletemplates.io/ajax/libs/prism/1.8.4/prism.min.js"></script>
<script src="https://pebbletemplates.io/ajax/libs/prism/1.8.4/components/prism-java.min.js"></script>
<script src="https://pebbletemplates.io/ajax/libs/prism/1.8.4/components/prism-twig.min.js"></script>
<script src="https://pebbletemplates.io/ajax/libs/prism/1.8.4/components/prism-markup.min.js"></script>
<!-- end:inject scripts -->

</body>
</html>